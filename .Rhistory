str(amostra2)
unique(amostra2$PARTICIPANTE)
## poli ####
poli <- read_csv("dadosS-poli-planilha.csv", locale = locale(encoding = "latin1"),
col_types = cols(.default = col_character(),
CONT_PREC = col_character(),
OCORRENCIA = col_character(),
CONT_SEGUINTE =  col_character(),
ANO.ENTREVISTA = col_integer(),
LOCALIZACAO = col_character()))%>%
mutate(across(where(is.character), as.factor))
head(poli)
str(poli)
levels(poli$VD)
## Juntar Barbosa e Poli ####
dadosAmostra2Poli <- bind_rows(amostra2, poli)
str(dadosAmostra2Poli)
#View(dadosAmostra2Poli)
unique(dadosAmostra2Poli$PARTICIPANTE)
## infs ####
infs <- read_csv("infs2025-amostra2ePoli-V2.csv", locale = locale(encoding = "UTF-8"),
col_types = cols(.default = col_character(),
IDADE = col_integer(),
INDICE_SOCIO = col_double(),
INDICE_ESCOL = col_double(),
INDICE_OCUPACAO = col_integer(),
INDICE_OUTRO_CARGO = col_integer(),
INDICE_OCUPACAO_SONHOS = col_integer(),
IDADE_MIGRACAO = col_integer(),
TEMPO_RESIDENCIA = col_integer(),
#NPESSOAS = col_integer(),
NRENDA = col_integer(),
INDICE_OCUPACAO_PAI = col_integer(),
INDICE_OCUPACAO_MAE = col_integer(),
INDICE_ESCOL_PAI = col_double(),
INDICE_ESCOL_MAE = col_double(),
AMIGO1_CLASSIFICACAO = col_integer(),
AMIGO2_CLASSIFICACAO = col_integer(),
AMIGO3_CLASSIFICACAO = col_integer(),
AMIGO4_CLASSIFICACAO = col_integer(),
AMIGO5_CLASSIFICACAO = col_integer(),
ESTADUALIDADE = col_integer(),
PAULISTIDADE = col_integer(),
NORDESTINIDADE = col_integer(),
INDICE_REDE_EST = col_integer(),
INDICE_REDE_NE = col_integer(),
INDICE_HABITOS = col_integer()
)) %>%
mutate(across(where(is.character), as.factor))
#mudar nível de variaveis
infs$RENDA_IND <- factor(infs$RENDA_IND, levels = c("1SM", "1a2SM", "2a4SM", "4a9SM", "10a19SM"))
levels(infs$RENDA_IND)
infs$RENDA_FAM <- factor(infs$RENDA_FAM, levels = c("1SM", "1a2SM", "2a4SM", "4a9SM", "10a19SM", "20+SM"))
levels(infs$RENDA_FAM)
head(infs)
str(infs)
## m2 ####
m2 <- read_csv("m2-bairros.csv", locale = locale(encoding = "UTF-8"),
col_types = cols(.default = col_character(),
PRECO = col_double(),
M2 = col_number(),
PRECOMETRO2 = col_number())) %>%
mutate(across(where(is.character), as.factor))
str(m2)
head(m2)
#calcular média do preço do m2 por bairro
m2$PRECOMETRO2
media_m2_bairro <- m2 %>%
group_by(BAIRRO) %>%
summarise(media_m2 = round(mean(PRECOMETRO2, na.rm = TRUE), 2)) %>%
arrange(media_m2) %>%
print(n = 22)
## juntar infs e m2 ####
setdiff(levels(infs$BAIRRO), levels(media_m2_bairro$BAIRRO))
infs2 <- left_join(infs, media_m2_bairro, by = "BAIRRO")
infs2$media_m2
## juntar dadosAmostra2Poli com dados ifds ####
dados <- left_join(dadosAmostra2Poli, infs2, by = "PARTICIPANTE")
#View(dados)
str(dados)
setdiff(levels(dadosAmostra2Poli$PARTICIPANTE), levels(infs$PARTICIPANTE))
## Filtragens e manipulações de variáveis ####
dados1 <- dados %>%
filter(VD %in% c("A", "P", "0", "H")) %>%
droplevels()
dados1$VD <- factor(dados1$VD, levels = c("A", "P", "0", "H"))
levels(dados1$VD)
dados2 <- dados1 %>%
mutate(CFP_abertura2 = case_when(
CONT_FON_PREC %in% c("i", "I", "j", "J", "u", "U", "w", "W") ~ "fechada",
CONT_FON_PREC %in% c("e", "o", "O") ~ "meio.fechada",
CONT_FON_PREC %in% c("3", "c") ~ "meio.aberta",
CONT_FON_PREC %in% c("a", "A") ~ "aberta"),
CFP_abertura2 = factor(CFP_abertura2, levels = c("fechada", "meio.fechada", "meio.aberta", "aberta")),
CFS_pontoc2 = case_when(
CONT_FON_SEG == "#" ~ "pausa",
CONT_FON_SEG %in% c("t", "d", "l", "n") ~ "coronal",
CONT_FON_SEG %in% c("h", "k", "g") ~ "dorsal",
CONT_FON_SEG %in% c("b", "f", "m", "p", "v") ~ "labial"),
CFS_pontoc2 = factor(CFS_pontoc2, levels = c("pausa", "coronal", "dorsal", "labial")),
CFS_sonoridade = case_when(
CONT_FON_SEG == "#" ~ "pausa",
CONT_FON_SEG %in% c("b", "d","g", "l", "m", "n", "v") ~ "sonora",
CONT_FON_SEG %in% c("f", "h", "k", "p", "t") ~ "surda"),
CFS_sonoridade = factor(CFS_sonoridade, levels = c("pausa", "sonora", "surda"))
)
levels(dados2$ESCOLARIDADE)
### PALATALIZAÇÃO ####
dados_AP <- dados2 %>%
filter(VD %in% c("P", "A")) %>%
droplevels()
levels(dados_AP$VD)
### APAGAMENTO ####
dados_S0 <- dados2 %>%
filter(!MORFEMA.PLURAL == "sim") %>%
mutate(VD = fct_collapse(VD,
S = c("A", "P", "H"),
`0` = "0")) %>%
droplevels()
levels(dados_S0$MORFEMA.PLURAL)
### ASPIRAÇÃO ####
dados_HAP <- dados2 %>%
filter(VD %in% c("A", "H", "P")) %>%
mutate(VD = fct_collapse(VD,
AP = c("A", "P"),
H = "H")) %>%
droplevels()
levels(dados_HAP$VD)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#
# DISTRIBUIÇÃO GERAL ####
distribuicao.geral <- dados2 %>%
count(VD) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
png("VD.png", width = 6.5, height = 4.5, units = "in", res = 300)
distribuicao.geral %>%
ggplot(aes(x = VD, y = prop, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
labs(x = "Variável Dependente", y = "Proporção de Ocorrência", fill = "VD") +
scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(aes(label = label),
vjust = -0.2,
size = 3.5) +
scale_fill_brewer(palette = "Reds")+
scale_y_continuous(labels = percent_format(accuracy = 1),
expand = expansion(mult = c(0, 0.15))) +  # aumenta espaço no topo para texto
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9),   # tamanho do título eixo Y
legend.position = "none")
dev.off()
### Número de Pessoas ####
AP.prop_NPESSOAS <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, NPESSOAS) %>%
group_by(NPESSOAS) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
AP.prop_NPESSOAS %>%
ggplot(aes(x = NPESSOAS, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
labs(x = "Renda Familiar", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
(AP.prop_NPESSOAS <- with(dados_AP, table(NPESSOAS, VD)))
chisq.test(AP.prop_NPESSOAS)
chisq.test(AP.prop_NPESSOAS[c(1,2)])
chisq.test(AP.prop_NPESSOAS)
(AP.prop_NPESSOAS <- with(dados_AP, table(NPESSOAS, VD)))
chisq.test(AP.prop_NPESSOAS)
chisq.test(AP.prop_NPESSOAS[c(1,2)])
chisq.test(AP.prop_NBANHEIROS[c(2,3)])
chisq.test(AP.prop_NPESSOAS[c(2,3)])
AP.prop_NPESSOAS %>%
ggplot(aes(x = NPESSOAS, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Renda Familiar", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
AP.prop_NPESSOAS %>%
ggplot(aes(x = NPESSOAS, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Renda Familiar", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
### Número de Pessoas ####
AP.prop_NPESSOAS <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, NPESSOAS) %>%
group_by(NPESSOAS) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
AP.prop_NPESSOAS %>%
ggplot(aes(x = NPESSOAS, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Renda Familiar", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
### Ocupação dos Pais ####
#### Pai ####
AP.prop_INDICE_OCUPACAO_PAI <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INDICE_OCUPACAO_PAI) %>%
group_by(INDICE_OCUPACAO_PAI) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_INDICE_OCUPACAO_PAI, aes(x = INDICE_OCUPACAO_PAI, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Variável Dependente", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds")+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
### Ocupação dos Pais ####
#### Pai ####
AP.prop_INDICE_OCUPACAO_PAI <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INDICE_OCUPACAO_PAI) %>%
group_by(INDICE_OCUPACAO_PAI) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
### Ocupação dos Pais ####
#### Pai ####
AP.prop_INDICE_OCUPACAO_PAI <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INDICE_OCUPACAO_PAI) %>%
group_by(INDICE_OCUPACAO_PAI) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_INDICE_OCUPACAO_PAI[5:8,], aes(x = INDICE_OCUPACAO_PAI, y = prop * 100, label = round(prop * 100, 1))) +
geom_point(stat = "identity", color = "black") +
stat_smooth(method=lm, se=TRUE, color="red")+
labs(x = "Índice de Ocupação", y = "Proporção de Palatalização") +
theme_light()
(AP.tab_INDICE_OCUPACAO_PAI<- with(dados_AP, table(INDICE_OCUPACAO_PAI, VD)))
chisq.test(AP.tab_INDICE_OCUPACAO_PAI) #sim
AP.mod_INDICE_OCUPACAO_PAI <- glm(VD ~ INDICE_OCUPACAO_PAI, data = dados_AP, family = binomial)
summary(AP.mod_INDICE_OCUPACAO_PAI)
lrm(VD ~ INDICE_OCUPACAO_PAI, data = dados_AP)
plot(allEffects(AP.mod_INDICE_OCUPACAO_PAI), type = "response")
#### Mãe ####
AP.prop_INDICE_OCUPACAO_MAE <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INDICE_OCUPACAO_MAE) %>%
group_by(INDICE_OCUPACAO_MAE) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_INDICE_OCUPACAO_MAE[6:10,], aes(x = INDICE_OCUPACAO_MAE, y = prop * 100, label = round(prop * 100, 1))) +
geom_point(stat = "identity", color = "black") +
stat_smooth(method=lm, se=TRUE, color="red")+
labs(x = "Índice de Ocupação", y = "Proporção de Palatalização") +
theme_light()
#### Mãe ####
AP.prop_INDICE_OCUPACAO_MAE <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INDICE_OCUPACAO_MAE) %>%
group_by(INDICE_OCUPACAO_MAE) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_INDICE_OCUPACAO_MAE[6:10,], aes(x = INDICE_OCUPACAO_MAE, y = prop * 100, label = round(prop * 100, 1))) +
geom_point(stat = "identity", color = "black") +
stat_smooth(method=lm, se=TRUE, color="red")+
labs(x = "Índice de Ocupação", y = "Proporção de Palatalização") +
theme_light()
AP.mod_INDICE_OCUPACAO_MAE <- glm(VD ~ INDICE_OCUPACAO_MAE, data = dados_AP, family = binomial)
summary(AP.mod_INDICE_OCUPACAO_MAE)
lrm(VD ~ INDICE_OCUPACAO_MAE, data = dados_AP)
plot(allEffects(AP.mod_INDICE_OCUPACAO_MAE), type = "response")
ggplot(AP.prop_INDICE_OCUPACAO_MAE[6:10,], aes(x = INDICE_OCUPACAO_MAE, y = prop * 100, label = round(prop * 100, 1))) +
geom_point(stat = "identity", color = "black") +
stat_smooth(method=lm, se=TRUE, color="red")+
labs(x = "Índice de Ocupação", y = "Proporção de Palatalização") +
theme_light()
### Infancia ####
AP.prop_INFANCIA_MEMORIA <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INFANCIA_MEMORIA) %>%
group_by(INFANCIA_MEMORIA) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_INFANCIA_MEMORIA, aes(x = INFANCIA_MEMORIA, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Renda Familiar", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
(AP.tab_LAZER_VIAGEM_VONTADE2 <- with(dados_AP, table(LAZER_VIAGEM_VONTADE2, VD)))
chisq.test(AP.tab_LAZER_VIAGEM_VONTADE2) #tem correlação
### Ocupação outro cargo ####
AP.prop_INDICE_OUTRO_CARGO <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INDICE_OUTRO_CARGO) %>%
group_by(INDICE_OUTRO_CARGO) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
### Ocupação outro cargo ####
AP.prop_INDICE_OUTRO_CARGO <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INDICE_OUTRO_CARGO) %>%
group_by(INDICE_OUTRO_CARGO) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_INDICE_OUTRO_CARGO[10:16,], aes(x = INDICE_OUTRO_CARGO, y = prop * 100, label = round(prop * 100, 1))) +
geom_point(stat = "identity", color = "black") +
stat_smooth(method=lm, se=TRUE, color="red")+
labs(x = "Índice de Ocupação", y = "Proporção de Palatalização") +
theme_light()
ggplot(AP.prop_INDICE_OUTRO_CARGO[10:16,], aes(x = INDICE_OUTRO_CARGO, y = prop * 100)) +
geom_point(stat = "identity", color = "black") +
stat_smooth(method=lm, se=TRUE, color="red")+
#labs(x = "Índice de Ocupação", y = "Proporção de Palatalização") +
theme_light()
ggplot(AP.prop_INDICE_OUTRO_CARGO[10:16,], aes(x = INDICE_OUTRO_CARGO, y = prop * 100)) +
geom_point(stat = "identity", color = "black") +
stat_smooth(method=lm, se=TRUE, color="red")+
#labs(x = "Índice de Ocupação", y = "Proporção de Palatalização") +
theme_light()
ggplot(AP.prop_INDICE_OUTRO_CARGO, aes(x = INDICE_OUTRO_CARGO, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Variável Dependente", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds")+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
AP.mod_INDICE_OUTRO_CARGO <- glm(VD ~ INDICE_OUTRO_CARGO, data = dados_AP, family = binomial)
summary(AP.mod_INDICE_OUTRO_CARGO)
lrm(VD ~ INDICE_OUTRO_CARGO, data = dados_AP)
plot(allEffects(AP.mod_INDICE_OCUPACAO), type = "response")
plot(allEffects(AP.mod_INDICE_OUTRO_CARGO), type = "response")
### Ocupação SONHOS ####
AP.prop_INDICE_OCUPACAO_SONHOS <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, INDICE_OCUPACAO_SONHOS) %>%
group_by(INDICE_OCUPACAO_SONHOS) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_INDICE_OCUPACAO_SONHOS[8:14,], aes(x = INDICE_OCUPACAO_SONHOS, y = prop * 100)) +
geom_point(stat = "identity", color = "black") +
stat_smooth(method=lm, se=TRUE, color="red")+
#labs(x = "Índice de Ocupação", y = "Proporção de Palatalização") +
theme_light()
ggplot(AP.prop_INDICE_OCUPACAO_SONHOS, aes(x = INDICE_OCUPACAO_SONHOS, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Variável Dependente", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds")+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
AP.mod_INDICE_OCUPACAO_SONHOS <- glm(VD ~ INDICE_OCUPACAO_SONHOS, data = dados_AP, family = binomial)
summary(AP.mod_INDICE_OCUPACAO_SONHOS)
lrm(VD ~ INDICE_OCUPACAO_SONHOS, data = dados_AP)
plot(allEffects(AP.mod_INDICE_OCUPACAO_SONHOS), type = "response")
### Ocupação distancia ####
AP.prop_OCUPACAO_DIST <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, OCUPACAO_DIST) %>%
group_by(OCUPACAO_DIST) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
### Ocupação distancia ####
AP.prop_OCUPACAO_DIST <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, OCUPACAO_DIST) %>%
group_by(OCUPACAO_DIST) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_OCUPACAO_DIST, aes(x = OCUPACAO_DIST, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
labs(x = "Renda Individual", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
ggplot(AP.prop_OCUPACAO_DIST, aes(x = OCUPACAO_DIST, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Renda Individual", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
(AP.tab_OCUPACAO_DIST2<- with(dados_AP, table(OCUPACAO_DIST, VD)))
chisq.test(AP.tab_OCUPACAO_DIST) #sim
(AP.tab_OCUPACAO_DIST<- with(dados_AP, table(OCUPACAO_DIST, VD)))
chisq.test(AP.tab_OCUPACAO_DIST) #sim
chisq.test(AP.tab_OCUPACAO_DIST[c(1,3),])
chisq.test(AP.tab_OCUPACAO_DIST[c(1,2),])
chisq.test(AP.tab_OCUPACAO_DIST[c(2,3),])
### Ocupação locomoção ####
AP.prop_OCUPACAO_LOCOMOCAO <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, OCUPACAO_LOCOMOCAO) %>%
group_by(OCUPACAO_LOCOMOCAO) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_OCUPACAO_LOCOMOCAO, aes(x = OCUPACAO_LOCOMOCAO, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Renda Individual", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(
color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(
color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
### Mega sena ####
AP.prop_MEGA_SENA <- dados_AP %>%
filter(CFS_pontoc2 == "coronal") %>%
count(VD, MEGA_SENA) %>%
group_by(MEGA_SENA) %>%
mutate(prop = prop.table(n),
label = paste0(round(prop * 100, 1), "%\n(", n, ")")) %>%
print()
ggplot(AP.prop_MEGA_SENA, aes(x = MEGA_SENA, y = prop * 100, fill = VD, label = label)) +
geom_bar(stat = "identity", color = "white") +
#labs(x = "Renda Individual", y = "Proporção de Ocorrência") +
#scale_x_discrete(labels = c("Alveolar", "Palatal", "Zero Fonético", "Aspirada"))+
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette = "Reds", name = "variantes", labels = c("Alveolar", "Palatal"))+
theme_minimal()+
theme(
panel.grid.major = element_line(
color = alpha("gray70", 0.2), linewidth = 0.5),
panel.grid.minor = element_line(
color = alpha("gray85", 0.1), linewidth = 0.25),
axis.title.x = element_text(size = 9),  # tamanho do título eixo X
axis.title.y = element_text(size = 9))
(AP.tab_MEGA_SENA<- with(dados_AP, table(MEGA_SENA, VD)))
chisq.test(AP.tab_MEGA_SENA) #sim
chisq.test(AP.tab_MEGA_SENA[c(2,3),])
chisq.test(AP.tab_MEGA_SENA[c(4,5),])
chisq.test(AP.tab_MEGA_SENA[c(5,6),])
